/*//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Variables and selectors////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////*/

let library = [];
let container = document.querySelector('.container');
let books = document.querySelectorAll('.book');
let form = document.querySelector('.addbookform');
let readBtns = document.querySelectorAll('.btn-read');
const addBtn = document.querySelector('.btn-add');

/*//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Constructor and Proto//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////*/

function Book(title, author, pages, read) {
	this.title = title;
	this.author = author;
	this.pages = pages;
	this.read = read;
}
Book.prototype.info = function() {
	console.log(
		`${this.title} by ${this.author}, ${this.pages} pages, ${(this.read = true
			? 'I have read this book'
			: 'not read yet')}`
	);
};

/*//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Functions//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////*/

function init() {
	renderLibrary();
}
function clear() {
	container.innerHTML = '';
}
function addBook() {
	let books = document.querySelectorAll('.book');
	let form = document.querySelector('.addbookform');
	const title = document.getElementById('title').value;
	const author = document.getElementById('author').value;
	const pages = document.getElementById('pages').value;
	const read = document.getElementById('read').checked;
	let newBook = new Book(title, author, pages, read);
	library.push(newBook);

	addBtn.classList.remove('hidden');
	books.forEach((book) => {
		book.classList.remove('hidden');
	});
	form.classList.add('hidden');
	clear();
	renderLibrary();
}

function removeBook(i) {
	library.splice(i, 1);
	clear();
	renderLibrary();
}

function renderLibrary() {
	library.forEach((book) =>
		container.insertAdjacentHTML(
			'afterbegin',
			`<div class='book' data-attr="${library.indexOf(book)}">
				<h2>${book.title}</h2>
				<div class="author"><h2>Author:</h2><p>${book.author}</p></div>
				<div class="pages"><h2>Number of Pages:</h2><p>${book.pages}</p></div>
				<div class="status"><h3>Read Status:</h3><p>${book.read === true
					? 'I have read this book'
					: 'Not read yet'}</p></div>
				<div class="div-btn"><button class="btn-change btn-read" data-attr="${library.indexOf(
					book
				)}" onclick="updateRead(${library.indexOf(book)})">${book.read === true
				? 'Unread'
				: 'Read'}</button><button class="btn-change btn-remove" data-attr="${library.indexOf(
				book
			)}" onclick="removeBook(${library.indexOf(book)})">Remove Book</button></div>
							</div>`
		)
	);
}

function updateRead(i) {
	let varBook = library[i];
	varBook.read ? (varBook.read = false) : (varBook.read = true);
	clear();
	renderLibrary();
}

function displayForm() {
	document.getElementById('title').value = '';
	document.getElementById('author').value = '';
	document.getElementById('pages').value = '';
	document.getElementById('read').checked = '';

	let books = document.querySelectorAll('.book');
	let form = document.querySelector('.addbookform');

	addBtn.classList.add('hidden');
	books.forEach((book) => {
		book.classList.add('hidden');
	});
	form.classList.remove('hidden');
}
/*//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Form Submit Event//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////*/

document.getElementById('submit-Btn').addEventListener('click', function(event) {
	event.preventDefault();
	addBook();
});
/*//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////Init            //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////*/

init();
